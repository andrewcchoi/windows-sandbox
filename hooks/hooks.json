{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": {
          "toolName": "Bash",
          "arguments": {
            "command": "docker.*prune|docker.*rm.*-f.*\\$|docker.*rmi.*-f"
          }
        },
        "type": "command",
        "command": "echo 'BLOCK: Destructive Docker commands require explicit user approval' && exit 1"
      },
      {
        "matcher": {
          "toolName": "Bash",
          "arguments": {
            "command": "docker.*--privileged"
          }
        },
        "type": "prompt",
        "prompt": "A privileged container was requested. This bypasses security isolation.\n\nCommand: {{arguments.command}}\n\nIs this necessary for the DevContainer setup? Respond ALLOW or BLOCK."
      }
    ]
  }
}
